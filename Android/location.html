<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Получение данных о местоположении смартфона (Location) &mdash; Telecom Notes 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/stylesheet.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e031e9a9"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Получение данных о сетях мобильной связи (2/3/4/5G)" href="telephony.html" />
    <link rel="prev" title="Context. Что это? Зачем это? Как работает?" href="context.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Telecom Notes
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Практические задания</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../HomeWork/home_work.html">Практические задания</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Git</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Git/git_tips.html">Git tips</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Kotlin</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Kotlin/kotlin.html">Kotlin</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Android</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="android.html">Android</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="02_first_app.html">Создание первого приложения (начало)</a></li>
<li class="toctree-l2"><a class="reference internal" href="app_structure.html">Структура проекта</a></li>
<li class="toctree-l2"><a class="reference internal" href="app_activity.html">Ползовательский интерфейс (первое Activity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="app_layout.html">Макеты элементов пользовательского интерфейса (Layout)</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_widgets.html">Работа виджетами из Activity</a></li>
<li class="toctree-l2"><a class="reference internal" href="context.html">Context. Что это? Зачем это? Как работает?</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Получение данных о местоположении смартфона (Location)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#locationmanager">Класс LocationManager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="telephony.html">Получение данных о сетях мобильной связи (2/3/4/5G)</a></li>
<li class="toctree-l2"><a class="reference internal" href="sockets/06_sockets_zmq.html">Работа c сокетами (Sockets).</a></li>
<li class="toctree-l2"><a class="reference internal" href="sockets/07_sockets_zmq_android.html">Библиотека Zero MQ (Android)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">PostgreSQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DataBase/database.html">PostgreSQL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">React</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../React/react.html">React</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Полезные ссылки</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../References/usefull_links.html">Полезные ссылки</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Telecom Notes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="android.html">Android</a></li>
      <li class="breadcrumb-item active">Получение данных о местоположении смартфона (Location)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Android/location.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="location">
<h1>Получение данных о местоположении смартфона (Location)<a class="headerlink" href="#location" title="Permalink to this heading"></a></h1>
<p><strong>Полный пример</strong> <a class="reference external" href="https://github.com/TelecomDep/android_notes/blob/master/Examples/android_notes/app/src/main/java/com/example/android_notes/activities/LocationActivity.kt">здесь</a>.</p>
<section id="locationmanager">
<h2>Класс LocationManager<a class="headerlink" href="#locationmanager" title="Permalink to this heading"></a></h2>
<p>Для получения доступа к информации о коортинатах LLA (Latitude, Longitude, Altitude) <code class="docutils literal notranslate"><span class="pre">разрешения\permissions</span></code>:</p>
<p><strong>AndroidManifest.xml</strong></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_FINE_LOCATION&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_COARSE_LOCATION&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span><span class="w"> </span><span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_BACKGROUND_LOCATION&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Получаем доступ к <code class="docutils literal notranslate"><span class="pre">LocationManager</span></code>:</p>
<p>This class provides access to the system location services. These services allow applications to obtain periodic updates of the device’s geographical location, or to be notified when the device enters the proximity of a given geographical location.
<a class="reference external" href="https://developer.android.com/reference/android/location/LocationManager">оригинал</a></p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span>// другие импорты
import android.location.Location
import android.location.LocationListener
import android.location.LocationManager

class LocationActivity : LocationListener, AppCompatActivity()  {

    companion object {
        private const val PERMISSION_REQUEST_ACCESS_LOCATION= 100
    }

    private lateinit var tvLat: TextView
    private lateinit var tvLon: TextView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        enableEdgeToEdge()
        setContentView(R.layout.activity_location)

        locationManager = this.getSystemService(Context.LOCATION_SERVICE) as LocationManager
        tvLat = findViewById(R.id.tv_lat) as TextView
        tvLon = findViewById(R.id.tv_lon) as TextView
    }

    ...
    // Здесь какой-то код
    ...

    // Переопределенный метод интерфейса LocationListener
    override fun onLocationChanged(location: Location) {
        tvLat.setText(location.latitude.toString())
        tvLon.setText(location.longitude.toString())
    }
}
</pre></div>
</div>
<p><strong>Включено ли определение местоположения?</strong></p>
<p>Проверка, включена ли функция определения местоположения вашего телефона. Проверяем при помощи инициализированного ранее объекта <code class="docutils literal notranslate"><span class="pre">locationManager</span></code>:</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isLocationEnabled</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">locationManager</span><span class="p">.</span><span class="na">isProviderEnabled</span><span class="p">(</span><span class="n">LocationManager</span><span class="p">.</span><span class="na">GPS_PROVIDER</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">locationManager</span><span class="p">.</span><span class="na">isProviderEnabled</span><span class="p">(</span><span class="n">LocationManager</span><span class="p">.</span><span class="na">NETWORK_PROVIDER</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Запрос разрешений на получения доступа к определению местоположения смартфона</strong></p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">requestPermissions</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ActivityCompat</span><span class="p">.</span><span class="na">requestPermissions</span><span class="p">(</span>
<span class="w">        </span><span class="k">this</span><span class="p">,</span>
<span class="w">        </span><span class="n">arrayOf</span><span class="p">(</span><span class="n">android</span><span class="p">.</span><span class="na">Manifest</span><span class="p">.</span><span class="na">permission</span><span class="p">.</span><span class="na">ACCESS_COARSE_LOCATION</span><span class="p">,</span>
<span class="w">            </span><span class="n">android</span><span class="p">.</span><span class="na">Manifest</span><span class="p">.</span><span class="na">permission</span><span class="p">.</span><span class="na">ACCESS_FINE_LOCATION</span><span class="p">),</span>
<span class="w">        </span><span class="n">PERMISSION_REQUEST_ACCESS_LOCATION</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Проверка, выданы ли разрешения</strong></p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">checkPermissions</span><span class="p">():</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ActivityCompat</span><span class="p">.</span><span class="na">checkSelfPermission</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">Manifest</span><span class="p">.</span><span class="na">permission</span><span class="p">.</span><span class="na">ACCESS_COARSE_LOCATION</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PackageManager</span><span class="p">.</span><span class="na">PERMISSION_GRANTED</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span><span class="n">ActivityCompat</span><span class="p">.</span><span class="na">checkSelfPermission</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">android</span><span class="p">.</span><span class="na">Manifest</span><span class="p">.</span><span class="na">permission</span><span class="p">.</span><span class="na">ACCESS_FINE_LOCATION</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PackageManager</span><span class="p">.</span><span class="na">PERMISSION_GRANTED</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Задаем условие обновления местопложения</strong></p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">locationManager</span><span class="p">.</span><span class="na">requestLocationUpdates</span><span class="p">(</span>
<span class="w">                </span><span class="n">LocationManager</span><span class="p">.</span><span class="na">GPS_PROVIDER</span><span class="p">,</span>
<span class="w">                </span><span class="m">1000L</span><span class="p">,</span>
<span class="w">                </span><span class="m">1f</span><span class="p">,</span>
<span class="w">                </span><span class="k">this</span>
<span class="w">            </span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="context.html" class="btn btn-neutral float-left" title="Context. Что это? Зачем это? Как работает?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="telephony.html" class="btn btn-neutral float-right" title="Получение данных о сетях мобильной связи (2/3/4/5G)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, ....</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>